import{S as g,P as x,H as M,W as P,a as S,C as R,d as W,M as v,e as p,V as y}from"./ARButton-71T4euHb.js";let u,s,a,e,w,c,d=null;z();function z(){u=document.createElement("div"),document.body.appendChild(u),a=new g,s=new x(70,window.innerWidth/window.innerHeight,.01,20);const l=new M(16777215,12303359,3);l.position.set(.5,1,.25),a.add(l),e=new P({antialias:!0,alpha:!0}),e.setPixelRatio(window.devicePixelRatio),e.setSize(window.innerWidth,window.innerHeight),e.setAnimationLoop(E),e.xr.enabled=!0,u.appendChild(e.domElement),e.xr.addEventListener("sessionstart",async()=>{const n=e.xr.getSession();if(!n)return;const r=await n.requestReferenceSpace("viewer");r&&(n.requestHitTestSource({space:r}).then(o=>{d=o,console.log("HitTestSource initialized:",d)}),n.addEventListener("end",()=>{d=null}))}),document.body.appendChild(S.createButton(e,{requiredFeatures:["hit-test","depth-sensing"],depthSensing:{usagePreference:["cpu-optimized","gpu-optimized"],dataFormatPreference:["luminance-alpha"]}}));const t=new R(.1,.1,.2,32).translate(0,.1,0),i=new W({color:16777215*Math.random()});c=new v(t,i),a.add(c),w=e.xr.getController(0),a.add(w),window.addEventListener("resize",C)}function C(){s.aspect=window.innerWidth/window.innerHeight,s.updateProjectionMatrix(),e.setSize(window.innerWidth,window.innerHeight)}function H(l,t,i){if(!i)return;const n=new y;n.setFromMatrixPosition(t.matrixWorld),n.project(s);const r=(n.x+1)/2,o=1-(n.y+1)/2,h=Math.min(Math.max(r,0),1),f=Math.min(Math.max(o,0),1);try{const m=i.getDepthInMeters(h,f);return t.position.distanceTo(s.position)>m?(console.log("Collision Detected!"),t.material.color.set(16711680),!0):(t.material.color.set(65280),!1)}catch(m){console.error("Error getting depth for collision check:",m)}}function E(l,t){if(!t)return;const i=e.xr.getReferenceSpace();if(!i||!d)return;const n=t.getHitTestResults(d),r=t.getViewerPose(i);if(!r)return;const o=t.getDepthInformation(r.views[0]);if(o){if(n.length>0){const h=n[0].getPose(i);H(t,c,o)||(c.position.setFromMatrixPosition(new p().fromArray(h.transform.matrix)),c.quaternion.setFromRotationMatrix(new p().fromArray(h.transform.matrix)))}e.render(a,s)}}
